<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Al Wassiya - Testament Islamique Simplifié</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Poppins:wght@300;400;500;600&family=Amiri:wght@400;700&display=swap" rel="stylesheet" />
<style>
  :root {
    --primary: #C9B178; --primary-dark: #A89262; --secondary: #2D4C68; --accent: #3A5F7E; --light: #F8F5EE; --dark: #1E1E24;
    --success: #4CAF50; --error: #E74C3C; --radius: 16px; --shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
    --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
  }
  * {margin:0; padding:0; box-sizing:border-box;}
  body {font-family:'Poppins', sans-serif; background:linear-gradient(135deg, #F8F5EE 0%, #E6E2D6 100%); color: var(--dark); min-height:100vh; direction:ltr;}
  body.rtl {direction: rtl; font-family: 'Amiri', 'Poppins', sans-serif;}
  .container {max-width: 900px; margin: 20px auto; padding: 20px;}
  .language-selector {position: fixed; top:20px; right:20px; z-index:1000; background: white; border-radius:10px; padding:10px; box-shadow: var(--shadow);}
  .language-selector select {border:none; background:transparent; font-size:14px; cursor:pointer;}
  .header {text-align:center; margin-bottom: 30px;}
  .logo {font-family:'Playfair Display', serif; font-size: 3.5rem; font-weight:700; color: var(--primary); margin-bottom: 10px; letter-spacing: 1px;}
  .arabic-title {font-family:'Amiri', serif; font-size:2.8rem; color: var(--primary-dark); margin:15px 0; direction: rtl;}
  .subtitle {font-size: 1.2rem; color: var(--secondary); margin-bottom: 25px; font-weight: 400;}
  .bismillah {font-size:2.2rem; color: var(--primary); margin: 25px 0; font-weight: 600; font-family:'Amiri', serif; direction: rtl;}
  form {background: white; padding: 25px; border-radius: var(--radius); box-shadow: var(--shadow);}
  .form-group {margin-bottom: 20px;}
  label {display: block; font-weight: 600; color: var(--secondary); margin-bottom: 8px;}
  input[type=text], input[type=tel], input[type=email], textarea, select {
    width: 100%; padding: 12px; border-radius: 8px; border: 2px solid #EDE8DD; font-size: 1rem; transition: border-color 0.3s;
  }
  input[type=text]:focus, input[type=tel]:focus, input[type=email]:focus, textarea:focus, select:focus {
    border-color: var(--primary); outline: none;
  }
  textarea {resize: vertical; min-height: 60px;}
  .actions {text-align:center; margin-top: 30px;}
  button {background: linear-gradient(135deg, var(--primary), var(--primary-dark)); color: white; font-weight: 600; font-size: 1.1rem; padding: 14px 30px; border:none; border-radius: 10px; cursor: pointer; transition: all 0.3s ease;}
  button:hover {background: var(--primary-dark);}
  .btn-secondary {background: transparent; border: 2px solid var(--primary); color: var(--primary); margin-left: 10px;}
  .btn-secondary:hover {background: var(--primary); color: white;}
  .hidden {display: none;}
  .dynamic-section {margin-top: 20px; padding: 20px; background: #F8F5EE; border-radius: 10px; border-left: 4px solid var(--primary);}
  .dynamic-item {background: white; border-radius: 10px; padding: 20px; margin-bottom: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);}
  .item-header {font-weight: 600; color: var(--secondary); margin-bottom: 15px;}
  .form-row {display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;}
  @media (max-width: 768px) {.form-row {grid-template-columns: 1fr;}}
</style>
</head>
<body>
<div class="language-selector">
  <select id="languageSelect" onchange="changeLanguage()">
    <option value="fr" selected>Français</option>
    <option value="en">English</option>
    <option value="ar">العربية</option>
  </select>
</div>
<div class="container">
  <div class="header">
    <div class="logo" id="headerTitle">Al Wassiya</div>
    <div class="arabic-title" id="arabicTitle">الوصية</div>
    <div class="subtitle" id="headerSubtitle">Votre Testament Islamique Simplifié</div>
    <div class="bismillah" id="bismillahText">بِسْمِ اللَّهِ الرَّحْمَنِ الرَّحِيم</div>
  </div>

  <!-- Page Étape 1 -->
  <section id="step1Section">
    <form id="step1Form">
      <div class="form-group">
        <label for="fullName" id="labelFullName">Nom complet</label>
        <input type="text" name="fullName" id="fullName" placeholder="Entrez votre nom complet" required />
      </div>
      <div class="form-group">
        <label for="phoneNumber" id="labelPhone">Téléphone</label>
        <input type="tel" name="phoneNumber" id="phoneNumber" placeholder="Entrez votre numéro de téléphone" required />
      </div>
      <div class="form-group">
        <label for="emailAddress" id="labelEmail">Email</label>
        <input type="email" name="emailAddress" id="emailAddress" placeholder="Entrez votre email" required />
      </div>
      <div class="actions">
        <button type="submit" id="btnContinue">Continuer vers l'étape 2</button>
      </div>
    </form>
  </section>

  <!-- Page Étape 2 -->
  <section id="step2Section" class="hidden">
    <form id="heritageForm">
      <div class="form-container">
        <!-- Enfants -->
        <div class="form-section">
          <h2 class="section-title"><i class="fas fa-users"></i> <span id="childrenTitle">Enfants</span></h2>
          <div class="form-group">
            <label for="nombreEnfants" id="nombreEnfantsLabel">Nombre d'enfants</label>
            <select id="nombreEnfants" name="nombreEnfants" onchange="generateChildrenFields()">
              <option value="0">Aucun enfant</option>
              <option value="1">1 enfant</option>
              <option value="2">2 enfants</option>
              <option value="3">3 enfants</option>
              <option value="4">4 enfants</option>
              <option value="5">5 enfants</option>
              <option value="6">6 enfants</option>
              <option value="7">7 enfants</option>
              <option value="8">8 enfants</option>
              <option value="9">9 enfants</option>
              <option value="10">10 enfants ou plus</option>
            </select>
          </div>
          <div id="childrenDetails" class="dynamic-section" style="display:none;"></div>
        </div>

        <!-- Frères -->
        <div class="form-section">
          <h2 class="section-title"><i class="fas fa-male"></i> <span id="brothersTitle">Frères</span></h2>
          <div class="form-group">
            <label for="nombreFreres" id="nombreFreresLabel">Nombre de frères</label>
            <select id="nombreFreres" name="nombreFreres" onchange="generateBrothersFields()">
              <option value="0">Aucun frère</option>
              <option value="1">1 frère</option>
              <option value="2">2 frères</option>
              <option value="3">3 frères</option>
              <option value="4">4 frères</option>
              <option value="5">5 frères</option>
              <option value="6">6 frères</option>
              <option value="7">7 frères</option>
              <option value="8">8 frères</option>
              <option value="9">9 frères</option>
              <option value="10">10 frères ou plus</option>
            </select>
          </div>
          <div id="brothersDetails" class="dynamic-section" style="display:none;"></div>
        </div>

        <!-- Sœurs -->
        <div class="form-section">
          <h2 class="section-title"><i class="fas fa-female"></i> <span id="sistersTitle">Sœurs</span></h2>
          <div class="form-group">
            <label for="nombreSoeurs" id="nombreSoeursLabel">Nombre de sœurs</label>
            <select id="nombreSoeurs" name="nombreSoeurs" onchange="generateSistersFields()">
              <option value="0">Aucune sœur</option>
              <option value="1">1 sœur</option>
              <option value="2">2 sœurs</option>
              <option value="3">3 sœurs</option>
              <option value="4">4 sœurs</option>
              <option value="5">5 sœurs</option>
              <option value="6">6 sœurs</option>
              <option value="7">7 sœurs</option>
              <option value="8">8 sœurs</option>
              <option value="9">9 sœurs</option>
              <option value="10">10 sœurs ou plus</option>
            </select>
          </div>
          <div id="sistersDetails" class="dynamic-section" style="display:none;"></div>
        </div>

        <!-- Autres héritiers -->
        <div class="form-section">
          <h2 class="section-title"><i class="fas fa-users-cog"></i> <span id="otherHeirsTitle">Autres héritiers</span></h2>
          <div class="form-group">
            <label for="autresHeritiers" id="autresHeritiersLabel">Autres membres de la famille héritiers (grands-parents, oncles, tantes, etc.)</label>
            <textarea id="autresHeritiers" name="autresHeritiers" rows="4" placeholder="Nom, lien de parenté, coordonnées..."></textarea>
          </div>
          <div class="form-group">
            <label for="remarquesHeritiers" id="remarquesHeritiersLabel">Remarques particulières sur les héritiers</label>
            <textarea id="remarquesHeritiers" name="remarquesHeritiers" rows="3"></textarea>
          </div>
        </div>
      </div>
      <div class="actions" style="text-align:center;">
        <button type="button" class="btn btn-secondary" onclick="showStep1()"><i class="fas fa-arrow-left"></i> Retour à l'étape 1</button>
        <button type="button" class="btn btn-primary" onclick="genererPDF()"><i class="fas fa-file-pdf"></i> Générer le PDF</button>
        <button type="button" class="btn btn-primary" onclick="alert('Fonction Continuer vers étape 3 à implémenter')">Continuer vers l'étape 3 <i class="fas fa-arrow-right"></i></button>
      </div>
    </form>
  </section>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
  const { jsPDF } = window.jspdf;

  const translations = {
    fr: { /* ... mêmes que précédemment ...*/ },
    en: { /* ... */ },
    ar: { /* ... */ }
  };

  let currentLanguage = 'fr';

  function changeLanguage() {
    const languageSelect = document.getElementById('languageSelect');
    currentLanguage = languageSelect.value;
    if(currentLanguage === 'ar') {
      document.body.classList.add('rtl');
      document.documentElement.setAttribute('lang', 'ar');
    } else {
      document.body.classList.remove('rtl');
      document.documentElement.setAttribute('lang', currentLanguage);
    }
    updateTexts();
    generateChildrenFields();
    generateBrothersFields();
    generateSistersFields();
  }

  function updateTexts() {
    const lang = translations[currentLanguage];
    for (const id in lang) {
      const el = document.getElementById(id);
      if (el) {
        if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') {
          el.placeholder = lang[id];
        } else {
          el.innerHTML = lang[id];
        }
      }
    }
  }

  // Gestion de la navigation entre étapes
  function showStep2() {
    document.getElementById('step1Section').classList.add('hidden');
    document.getElementById('step2Section').classList.remove('hidden');
  }
  function showStep1() {
    document.getElementById('step2Section').classList.add('hidden');
    document.getElementById('step1Section').classList.remove('hidden');
  }

  // Intercepte la validation formulaire étape 1 pour passer à étape 2
  document.getElementById('step1Form').addEventListener('submit', function(e){
    e.preventDefault();
    showStep2();
  });

  // Fonctions dynamiques pour enfants, frères, soeurs (similaires au code précédent)
  function generateChildrenFields() {
    const nombre = parseInt(document.getElementById('nombreEnfants').value,10);
    const container = document.getElementById('childrenDetails');
    if(nombre === 0) {
      container.style.display = 'none';
      container.innerHTML = '';
      return;
    }
    container.style.display = 'block';
    container.innerHTML = '';
    for(let i=1; i<=nombre; i++) {
      const div = document.createElement('div');
      div.className = 'dynamic-item';
      div.innerHTML = `
        <div class="item-header">${currentLanguage === 'ar' ? 'الطفل' : currentLanguage === 'en' ? 'Child' : 'Enfant'} ${i}</div>
        <div class="form-row">
          <div class="form-group">
            <label>${currentLanguage === 'ar' ? 'الاسم' : currentLanguage === 'en' ? 'Name' : 'Nom'}</label>
            <input type="text" name="nomEnfant${i}" placeholder="${currentLanguage === 'ar' ? 'اسم الطفل' : currentLanguage === 'en' ? "Child's name" : "Nom de l'enfant"}" />
          </div>
          <div class="form-group">
            <label>${currentLanguage === 'ar' ? 'الهاتف' : currentLanguage === 'en' ? 'Phone' : 'Téléphone'}</label>
            <input type="tel" name="telephoneEnfant${i}" placeholder="${currentLanguage === 'ar' ? 'رقم الهاتف' : currentLanguage === 'en' ? "Phone number" : "Numéro de téléphone"}" />
          </div>
        </div>
        <div class="form-group">
          <label>${currentLanguage === 'ar' ? 'العنوان / وسيلة اتصال' : currentLanguage === 'en' ? 'Address / Contact' : 'Adresse / Moyen de contact'}</label>
          <textarea name="adresseEnfant${i}" rows="2" placeholder="${currentLanguage === 'ar' ? 'العنوان أو وسيلة الاتصال' : currentLanguage === 'en' ? 'Address or contact method' : 'Adresse ou moyen de contact'}"></textarea>
        </div>
      `;
      container.appendChild(div);
    }
  }

  function generateBrothersFields() {
    const nombre = parseInt(document.getElementById('nombreFreres').value, 10);
    const container = document.getElementById('brothersDetails');
    if(nombre === 0) {
      container.style.display = 'none';
      container.innerHTML = '';
      return;
    }
    container.style.display = 'block';
    container.innerHTML = '';
    for(let i=1; i<=nombre; i++) {
      const div = document.createElement('div');
      div.className = 'dynamic-item';
      div.innerHTML = `
        <div class="item-header">${currentLanguage === 'ar' ? 'الأخ' : currentLanguage === 'en' ? 'Brother' : 'Frère'} ${i}</div>
        <div class="form-row">
          <div class="form-group">
            <label>${currentLanguage === 'ar' ? 'الاسم' : currentLanguage === 'en' ? 'Name' : 'Nom'}</label>
            <input type="text" name="nomFrere${i}" placeholder="${currentLanguage === 'ar' ? 'اسم الأخ' : currentLanguage === 'en' ? "Brother's name" : 'Nom du frère'}" />
          </div>
          <div class="form-group">
            <label>${currentLanguage === 'ar' ? 'الهاتف' : currentLanguage === 'en' ? 'Phone' : 'Téléphone'}</label>
            <input type="tel" name="telephoneFrere${i}" placeholder="${currentLanguage === 'ar' ? 'رقم الهاتف' : currentLanguage === 'en' ? 'Phone number' : 'Numéro de téléphone'}" />
          </div>
        </div>
        <div class="form-group">
          <label>${currentLanguage === 'ar' ? 'العنوان / وسيلة اتصال' : currentLanguage === 'en' ? 'Address / Contact' : 'Adresse / Moyen de contact'}</label>
          <textarea name="adresseFrere${i}" rows="2" placeholder="${currentLanguage === 'ar' ? 'العنوان أو وسيلة الاتصال' : currentLanguage === 'en' ? 'Address or contact method' : 'Adresse ou moyen de contact'}"></textarea>
        </div>
      `;
      container.appendChild(div);
    }
  }

  function generateSistersFields() {
    const nombre = parseInt(document.getElementById('nombreSoeurs').value, 10);
    const container = document.getElementById('sistersDetails');
    if(nombre === 0) {
      container.style.display = 'none';
      container.innerHTML = '';
      return;
    }
    container.style.display = 'block';
    container.innerHTML = '';
    for(let i=1; i<=nombre; i++) {
      const div = document.createElement('div');
      div.className = 'dynamic-item';
      div.innerHTML = `
        <div class="item-header">${currentLanguage === 'ar' ? 'الأخت' : currentLanguage === 'en' ? 'Sister' : 'Sœur'} ${i}</div>
        <div class="form-row">
          <div class="form-group">
            <label>${currentLanguage === 'ar' ? 'الاسم' : currentLanguage === 'en' ? 'Name' : 'Nom'}</label>
            <input type="text" name="nomSoeur${i}" placeholder="${currentLanguage === 'ar' ? 'اسم الأخت' : currentLanguage === 'en' ? "Sister's name" : 'Nom de la sœur'}" />
          </div>
          <div class="form-group">
            <label>${currentLanguage === 'ar' ? 'الهاتف' : currentLanguage === 'en' ? 'Phone' : 'Téléphone'}</label>
            <input type="tel" name="telephoneSoeur${i}" placeholder="${currentLanguage === 'ar' ? 'رقم الهاتف' : currentLanguage === 'en' ? 'Phone number' : 'Numéro de téléphone'}" />
          </div>
        </div>
        <div class="form-group">
          <label>${currentLanguage === 'ar' ? 'العنوان / وسيلة اتصال' : currentLanguage === 'en' ? 'Address / Contact' : 'Adresse / Moyen de contact'}</label>
          <textarea name="adresseSoeur${i}" rows="2" placeholder="${currentLanguage === 'ar' ? 'العنوان أو وسيلة الاتصال' : currentLanguage === 'en' ? 'Address or contact method' : 'Adresse ou moyen de contact'}"></textarea>
        </div>
      `;
      container.appendChild(div);
    }
  }

  // Scroll to top helper
  function scrollToTop() {
    window.scroll({ top:0, behavior:'smooth' });
  }

  function genererPDF() {
    // Le code complet de génération PDF avec gestion arabe (comme avant) peut être inséré ici
    alert("Génération PDF à implémenter");
  }

  window.onload = () => {
    changeLanguage();
    generateChildrenFields();
    generateBrothersFields();
    generateSistersFields();
  };
</script>

<!-- Zones dynamiques pour frères et sœurs, non dans formulaire mais pour éviter déconvenues -->
<div id="brothersDetails" class="dynamic-section hidden"></div>
<div id="sistersDetails" class="dynamic-section hidden"></div>

</body>
</html>
